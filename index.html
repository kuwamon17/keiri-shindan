<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>経理パーソナリティ診断 | あなたの強みを発見しよう</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', 'Meiryo', sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    padding: 20px;
  }
  .container {
    max-width: 800px;
    margin: 0 auto;
    background: white;
    border-radius: 20px;
    padding: 40px 30px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
  }
  h1 {
    text-align: center;
    color: #4a2c8a;
    font-size: 1.8em;
    margin-bottom: 8px;
  }
  .subtitle {
    text-align: center;
    color: #666;
    font-size: 0.95em;
    margin-bottom: 30px;
  }
  .intro-box {
    background: #f0ebff;
    border-left: 4px solid #764ba2;
    padding: 15px 20px;
    border-radius: 8px;
    margin-bottom: 30px;
    font-size: 0.9em;
    color: #444;
    line-height: 1.7;
  }
  .how-to {
    background: #fff8e1;
    border: 1px solid #ffc107;
    border-radius: 8px;
    padding: 15px 20px;
    margin-bottom: 30px;
    font-size: 0.88em;
    color: #555;
    line-height: 1.8;
  }
  .how-to h3 { color: #e65100; margin-bottom: 8px; font-size: 1em; }
  .question-block {
    margin-bottom: 28px;
    padding: 18px;
    background: #fafafa;
    border-radius: 12px;
    border: 1px solid #e0e0e0;
    transition: box-shadow 0.2s;
  }
  .question-block:hover { box-shadow: 0 4px 12px rgba(118,75,162,0.15); }
  .question-number {
    font-size: 0.78em;
    color: #764ba2;
    font-weight: bold;
    margin-bottom: 6px;
  }
  .question-text {
    font-size: 0.98em;
    color: #333;
    margin-bottom: 14px;
    line-height: 1.6;
  }
  .options {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
  }
  .option-label {
    display: flex;
    flex-direction: column;
    align-items: center;
    cursor: pointer;
    flex: 1;
    min-width: 55px;
  }
  .option-label input[type="radio"] { display: none; }
  .option-btn {
    width: 100%;
    padding: 10px 4px;
    border: 2px solid #d0c0f0;
    border-radius: 8px;
    text-align: center;
    font-size: 0.78em;
    color: #555;
    background: white;
    transition: all 0.2s;
    cursor: pointer;
    line-height: 1.3;
  }
  .option-label input[type="radio"]:checked + .option-btn {
    background: #764ba2;
    color: white;
    border-color: #764ba2;
    box-shadow: 0 3px 8px rgba(118,75,162,0.4);
    transform: scale(1.05);
  }
  .option-btn:hover { border-color: #764ba2; background: #f0ebff; }
  .submit-btn {
    display: block;
    width: 100%;
    padding: 18px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    border: none;
    border-radius: 12px;
    font-size: 1.2em;
    font-weight: bold;
    cursor: pointer;
    margin-top: 30px;
    transition: all 0.3s;
    letter-spacing: 1px;
  }
  .submit-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(118,75,162,0.5); }
  .error-msg {
    display: none;
    color: #e53935;
    text-align: center;
    margin-top: 15px;
    font-size: 0.9em;
    font-weight: bold;
  }
  /* RESULT SECTION */
  #resultSection { display: none; }
  .result-header {
    text-align: center;
    padding: 30px 20px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    border-radius: 16px;
    color: white;
    margin-bottom: 25px;
  }
  .result-header h2 { font-size: 1.1em; margin-bottom: 8px; opacity: 0.9; }
  .char-img-wrap {
    width: 180px;
    height: 180px;
    border-radius: 50%;
    overflow: hidden;
    border: 5px solid white;
    box-shadow: 0 8px 25px rgba(0,0,0,0.3);
    margin: 0 auto 18px;
    background: #f0f0f0;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .char-img-wrap img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  .char-emoji { font-size: 80px; }
  .result-type {
    font-size: 1.8em;
    font-weight: bold;
    margin-bottom: 8px;
  }
  .result-tagline {
    font-size: 1.1em;
    opacity: 0.95;
    font-style: italic;
  }
  .score-section {
    background: #f8f5ff;
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 20px;
  }
  .score-section h3 { color: #4a2c8a; margin-bottom: 15px; font-size: 1em; }
  .score-row {
    display: flex;
    align-items: center;
    margin-bottom: 10px;
    gap: 10px;
  }
  .score-label { width: 130px; font-size: 0.82em; color: #555; flex-shrink: 0; }
  .score-bar-wrap { flex: 1; background: #e0d0ff; border-radius: 6px; height: 16px; }
  .score-bar { height: 16px; border-radius: 6px; background: linear-gradient(90deg, #667eea, #764ba2); transition: width 0.8s ease; }
  .score-num { font-size: 0.85em; color: #764ba2; font-weight: bold; width: 40px; text-align: right; }
  .result-detail {
    background: white;
    border: 2px solid #d0c0f0;
    border-radius: 12px;
    padding: 25px;
    margin-bottom: 20px;
  }
  .result-detail h3 { color: #4a2c8a; margin-bottom: 10px; font-size: 1.05em; }
  .result-detail p { color: #444; line-height: 1.7; margin-bottom: 15px; font-size: 0.92em; }
  .jobs-list {
    display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px;
  }
  .job-tag {
    background: #f0ebff; color: #4a2c8a; padding: 5px 12px;
    border-radius: 20px; font-size: 0.82em; border: 1px solid #c0a8f0;
  }
  .career-box {
    background: #e8f5e9; border-left: 4px solid #4caf50;
    padding: 12px 16px; border-radius: 8px; font-size: 0.88em;
    color: #2e7d32; line-height: 1.6; margin-top: 12px;
  }
  /* WEB LINK BOX */
  .web-link-box {
    background: linear-gradient(135deg, #e3f2fd, #f3e5f5);
    border: 2px solid #764ba2;
    border-radius: 12px;
    padding: 20px 25px;
    margin-bottom: 20px;
    text-align: center;
  }
  .web-link-box h3 { color: #4a2c8a; margin-bottom: 8px; font-size: 1em; }
  .web-link-box p { color: #555; font-size: 0.88em; margin-bottom: 12px; line-height: 1.6; }
  .web-link-btn {
    display: inline-block;
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    padding: 12px 28px;
    border-radius: 30px;
    text-decoration: none;
    font-weight: bold;
    font-size: 0.95em;
    transition: all 0.3s;
    box-shadow: 0 4px 12px rgba(118,75,162,0.3);
  }
  .web-link-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 18px rgba(118,75,162,0.5); }
  .web-url-text {
    margin-top: 10px;
    font-size: 0.78em;
    color: #888;
    word-break: break-all;
  }
  /* 免責事項 */
  .disclaimer {
    background: #f5f5f5;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 14px 18px;
    font-size: 0.78em;
    color: #777;
    line-height: 1.7;
    margin-bottom: 20px;
    text-align: left;
  }
  .disclaimer strong { color: #555; }
  .retry-btn {
    display: block;
    width: 100%;
    padding: 15px;
    background: white;
    color: #764ba2;
    border: 2px solid #764ba2;
    border-radius: 12px;
    font-size: 1em;
    font-weight: bold;
    cursor: pointer;
    margin-top: 10px;
    transition: all 0.3s;
    letter-spacing: 1px;
  }
  .retry-btn:hover { background: #f0ebff; }
  .progress-bar-wrap {
    background: #e0d0ff;
    border-radius: 6px;
    height: 8px;
    margin-bottom: 25px;
  }
  .progress-bar-fill { height: 8px; border-radius: 6px; background: linear-gradient(90deg, #667eea, #764ba2); width: 0%; transition: width 0.3s; }
  .progress-text { font-size: 0.8em; color: #888; text-align: right; margin-top: 4px; }
  @media (max-width: 600px) {
    .container { padding: 25px 15px; }
    h1 { font-size: 1.4em; }
    .options { gap: 5px; }
    .option-btn { font-size: 0.72em; padding: 8px 2px; }
    .result-type { font-size: 1.5em; }
    .score-label { width: 110px; font-size: 0.78em; }
  }
</style>
</head>
<body>
<div class="container">
  <!-- QUIZ SECTION -->
  <div id="quizSection">
    <h1>🏢 経理パーソナリティ診断</h1>
    <p class="subtitle">あなたの強みを活かすキャリアのヒントを発見しよう</p>
    <div class="intro-box">
      経理・財務・経営企画に携わる方々には、それぞれ異なる個性と強みがあります。この診断では、日常業務での考え方や行動パターンをもとに、あなたが最も力を発揮できるタイプを探ります。正解・不正解はありません。ありのままのご自身でお答えください。
    </div>
    <div class="how-to">
      <h3>📋 回答方法</h3>
      各質問に対して、あなたの日常的な行動や考え方に最も近い選択肢を1つ選んでください。<br>
      <strong>1＝全くそう思わない ／ 2＝あまりそう思わない ／ 3＝どちらでもない ／ 4＝ややそう思う ／ 5＝非常にそう思う</strong>
    </div>
    <div class="progress-bar-wrap">
      <div class="progress-bar-fill" id="progressBar"></div>
    </div>
    <p class="progress-text" id="progressText">0 / 20 問回答済み</p>

    <form id="diagForm" onsubmit="return false;">

      <div class="question-block" id="qblock1">
        <div class="question-number">Q1</div>
        <div class="question-text">仕訳入力後、必ず自分で検算・確認する習慣がある</div>
        <div class="options">
          <label class="option-label">
            <input type="radio" name="Q1" value="1" onchange="updateProgress()">
            <div class="option-btn">1<br>全くそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q1" value="2" onchange="updateProgress()">
            <div class="option-btn">2<br>あまりそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q1" value="3" onchange="updateProgress()">
            <div class="option-btn">3<br>どちらでも<br>ない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q1" value="4" onchange="updateProgress()">
            <div class="option-btn">4<br>やや<br>そう思う</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q1" value="5" onchange="updateProgress()">
            <div class="option-btn">5<br>非常に<br>そう思う</div>
          </label>
        </div>
      </div>

      <div class="question-block" id="qblock2">
        <div class="question-number">Q2</div>
        <div class="question-text">数字の背景にある事業・取引の実態を常に意識している</div>
        <div class="options">
          <label class="option-label">
            <input type="radio" name="Q2" value="1" onchange="updateProgress()">
            <div class="option-btn">1<br>全くそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q2" value="2" onchange="updateProgress()">
            <div class="option-btn">2<br>あまりそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q2" value="3" onchange="updateProgress()">
            <div class="option-btn">3<br>どちらでも<br>ない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q2" value="4" onchange="updateProgress()">
            <div class="option-btn">4<br>やや<br>そう思う</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q2" value="5" onchange="updateProgress()">
            <div class="option-btn">5<br>非常に<br>そう思う</div>
          </label>
        </div>
      </div>

      <div class="question-block" id="qblock3">
        <div class="question-number">Q3</div>
        <div class="question-text">他部署との調整や折衝は、むしろ自分の得意分野だと感じる</div>
        <div class="options">
          <label class="option-label">
            <input type="radio" name="Q3" value="1" onchange="updateProgress()">
            <div class="option-btn">1<br>全くそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q3" value="2" onchange="updateProgress()">
            <div class="option-btn">2<br>あまりそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q3" value="3" onchange="updateProgress()">
            <div class="option-btn">3<br>どちらでも<br>ない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q3" value="4" onchange="updateProgress()">
            <div class="option-btn">4<br>やや<br>そう思う</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q3" value="5" onchange="updateProgress()">
            <div class="option-btn">5<br>非常に<br>そう思う</div>
          </label>
        </div>
      </div>

      <div class="question-block" id="qblock4">
        <div class="question-number">Q4</div>
        <div class="question-text">業務フローの非効率な点を発見すると、改善せずにはいられない</div>
        <div class="options">
          <label class="option-label">
            <input type="radio" name="Q4" value="1" onchange="updateProgress()">
            <div class="option-btn">1<br>全くそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q4" value="2" onchange="updateProgress()">
            <div class="option-btn">2<br>あまりそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q4" value="3" onchange="updateProgress()">
            <div class="option-btn">3<br>どちらでも<br>ない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q4" value="4" onchange="updateProgress()">
            <div class="option-btn">4<br>やや<br>そう思う</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q4" value="5" onchange="updateProgress()">
            <div class="option-btn">5<br>非常に<br>そう思う</div>
          </label>
        </div>
      </div>

      <div class="question-block" id="qblock5">
        <div class="question-number">Q5</div>
        <div class="question-text">状況の変化に応じて自分のやり方を柔軟に変えることができる</div>
        <div class="options">
          <label class="option-label">
            <input type="radio" name="Q5" value="1" onchange="updateProgress()">
            <div class="option-btn">1<br>全くそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q5" value="2" onchange="updateProgress()">
            <div class="option-btn">2<br>あまりそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q5" value="3" onchange="updateProgress()">
            <div class="option-btn">3<br>どちらでも<br>ない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q5" value="4" onchange="updateProgress()">
            <div class="option-btn">4<br>やや<br>そう思う</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q5" value="5" onchange="updateProgress()">
            <div class="option-btn">5<br>非常に<br>そう思う</div>
          </label>
        </div>
      </div>

      <div class="question-block" id="qblock6">
        <div class="question-number">Q6</div>
        <div class="question-text">定型業務を正確にこなすことに、強いやりがいを感じる</div>
        <div class="options">
          <label class="option-label">
            <input type="radio" name="Q6" value="1" onchange="updateProgress()">
            <div class="option-btn">1<br>全くそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q6" value="2" onchange="updateProgress()">
            <div class="option-btn">2<br>あまりそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q6" value="3" onchange="updateProgress()">
            <div class="option-btn">3<br>どちらでも<br>ない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q6" value="4" onchange="updateProgress()">
            <div class="option-btn">4<br>やや<br>そう思う</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q6" value="5" onchange="updateProgress()">
            <div class="option-btn">5<br>非常に<br>そう思う</div>
          </label>
        </div>
      </div>

      <div class="question-block" id="qblock7">
        <div class="question-number">Q7</div>
        <div class="question-text">数字をもとに経営陣や上司に提案・意見することを積極的に行う</div>
        <div class="options">
          <label class="option-label">
            <input type="radio" name="Q7" value="1" onchange="updateProgress()">
            <div class="option-btn">1<br>全くそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q7" value="2" onchange="updateProgress()">
            <div class="option-btn">2<br>あまりそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q7" value="3" onchange="updateProgress()">
            <div class="option-btn">3<br>どちらでも<br>ない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q7" value="4" onchange="updateProgress()">
            <div class="option-btn">4<br>やや<br>そう思う</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q7" value="5" onchange="updateProgress()">
            <div class="option-btn">5<br>非常に<br>そう思う</div>
          </label>
        </div>
      </div>

      <div class="question-block" id="qblock8">
        <div class="question-number">Q8</div>
        <div class="question-text">後輩や部下の育成に時間を使うことを惜しまない</div>
        <div class="options">
          <label class="option-label">
            <input type="radio" name="Q8" value="1" onchange="updateProgress()">
            <div class="option-btn">1<br>全くそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q8" value="2" onchange="updateProgress()">
            <div class="option-btn">2<br>あまりそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q8" value="3" onchange="updateProgress()">
            <div class="option-btn">3<br>どちらでも<br>ない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q8" value="4" onchange="updateProgress()">
            <div class="option-btn">4<br>やや<br>そう思う</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q8" value="5" onchange="updateProgress()">
            <div class="option-btn">5<br>非常に<br>そう思う</div>
          </label>
        </div>
      </div>

      <div class="question-block" id="qblock9">
        <div class="question-number">Q9</div>
        <div class="question-text">RPA・AIなどの新技術を業務に取り入れることに前向きだ</div>
        <div class="options">
          <label class="option-label">
            <input type="radio" name="Q9" value="1" onchange="updateProgress()">
            <div class="option-btn">1<br>全くそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q9" value="2" onchange="updateProgress()">
            <div class="option-btn">2<br>あまりそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q9" value="3" onchange="updateProgress()">
            <div class="option-btn">3<br>どちらでも<br>ない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q9" value="4" onchange="updateProgress()">
            <div class="option-btn">4<br>やや<br>そう思う</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q9" value="5" onchange="updateProgress()">
            <div class="option-btn">5<br>非常に<br>そう思う</div>
          </label>
        </div>
      </div>

      <div class="question-block" id="qblock10">
        <div class="question-number">Q10</div>
        <div class="question-text">単独作業とチーム作業のどちらでも同じように高いパフォーマンスを発揮できる</div>
        <div class="options">
          <label class="option-label">
            <input type="radio" name="Q10" value="1" onchange="updateProgress()">
            <div class="option-btn">1<br>全くそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q10" value="2" onchange="updateProgress()">
            <div class="option-btn">2<br>あまりそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q10" value="3" onchange="updateProgress()">
            <div class="option-btn">3<br>どちらでも<br>ない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q10" value="4" onchange="updateProgress()">
            <div class="option-btn">4<br>やや<br>そう思う</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q10" value="5" onchange="updateProgress()">
            <div class="option-btn">5<br>非常に<br>そう思う</div>
          </label>
        </div>
      </div>

      <div class="question-block" id="qblock11">
        <div class="question-number">Q11</div>
        <div class="question-text">ミスが発生した場合、原因を徹底的に追究し再発防止策を講じる</div>
        <div class="options">
          <label class="option-label">
            <input type="radio" name="Q11" value="1" onchange="updateProgress()">
            <div class="option-btn">1<br>全くそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q11" value="2" onchange="updateProgress()">
            <div class="option-btn">2<br>あまりそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q11" value="3" onchange="updateProgress()">
            <div class="option-btn">3<br>どちらでも<br>ない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q11" value="4" onchange="updateProgress()">
            <div class="option-btn">4<br>やや<br>そう思う</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q11" value="5" onchange="updateProgress()">
            <div class="option-btn">5<br>非常に<br>そう思う</div>
          </label>
        </div>
      </div>

      <div class="question-block" id="qblock12">
        <div class="question-number">Q12</div>
        <div class="question-text">予算・実績の差異分析をする際、単なる数値比較を超えた洞察を心がけている</div>
        <div class="options">
          <label class="option-label">
            <input type="radio" name="Q12" value="1" onchange="updateProgress()">
            <div class="option-btn">1<br>全くそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q12" value="2" onchange="updateProgress()">
            <div class="option-btn">2<br>あまりそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q12" value="3" onchange="updateProgress()">
            <div class="option-btn">3<br>どちらでも<br>ない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q12" value="4" onchange="updateProgress()">
            <div class="option-btn">4<br>やや<br>そう思う</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q12" value="5" onchange="updateProgress()">
            <div class="option-btn">5<br>非常に<br>そう思う</div>
          </label>
        </div>
      </div>

      <div class="question-block" id="qblock13">
        <div class="question-number">Q13</div>
        <div class="question-text">社内の関係者が多いプロジェクトほど、やりがいを感じる</div>
        <div class="options">
          <label class="option-label">
            <input type="radio" name="Q13" value="1" onchange="updateProgress()">
            <div class="option-btn">1<br>全くそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q13" value="2" onchange="updateProgress()">
            <div class="option-btn">2<br>あまりそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q13" value="3" onchange="updateProgress()">
            <div class="option-btn">3<br>どちらでも<br>ない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q13" value="4" onchange="updateProgress()">
            <div class="option-btn">4<br>やや<br>そう思う</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q13" value="5" onchange="updateProgress()">
            <div class="option-btn">5<br>非常に<br>そう思う</div>
          </label>
        </div>
      </div>

      <div class="question-block" id="qblock14">
        <div class="question-number">Q14</div>
        <div class="question-text">新しい会計基準や制度改正を積極的に学び、業務に適用しようとしている</div>
        <div class="options">
          <label class="option-label">
            <input type="radio" name="Q14" value="1" onchange="updateProgress()">
            <div class="option-btn">1<br>全くそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q14" value="2" onchange="updateProgress()">
            <div class="option-btn">2<br>あまりそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q14" value="3" onchange="updateProgress()">
            <div class="option-btn">3<br>どちらでも<br>ない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q14" value="4" onchange="updateProgress()">
            <div class="option-btn">4<br>やや<br>そう思う</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q14" value="5" onchange="updateProgress()">
            <div class="option-btn">5<br>非常に<br>そう思う</div>
          </label>
        </div>
      </div>

      <div class="question-block" id="qblock15">
        <div class="question-number">Q15</div>
        <div class="question-text">複数のプロジェクトやタスクを同時に管理することが得意だ</div>
        <div class="options">
          <label class="option-label">
            <input type="radio" name="Q15" value="1" onchange="updateProgress()">
            <div class="option-btn">1<br>全くそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q15" value="2" onchange="updateProgress()">
            <div class="option-btn">2<br>あまりそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q15" value="3" onchange="updateProgress()">
            <div class="option-btn">3<br>どちらでも<br>ない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q15" value="4" onchange="updateProgress()">
            <div class="option-btn">4<br>やや<br>そう思う</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q15" value="5" onchange="updateProgress()">
            <div class="option-btn">5<br>非常に<br>そう思う</div>
          </label>
        </div>
      </div>

      <div class="question-block" id="qblock16">
        <div class="question-number">Q16</div>
        <div class="question-text">資料や報告書の数値は、小数点レベルまで正確さにこだわる</div>
        <div class="options">
          <label class="option-label">
            <input type="radio" name="Q16" value="1" onchange="updateProgress()">
            <div class="option-btn">1<br>全くそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q16" value="2" onchange="updateProgress()">
            <div class="option-btn">2<br>あまりそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q16" value="3" onchange="updateProgress()">
            <div class="option-btn">3<br>どちらでも<br>ない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q16" value="4" onchange="updateProgress()">
            <div class="option-btn">4<br>やや<br>そう思う</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q16" value="5" onchange="updateProgress()">
            <div class="option-btn">5<br>非常に<br>そう思う</div>
          </label>
        </div>
      </div>

      <div class="question-block" id="qblock17">
        <div class="question-number">Q17</div>
        <div class="question-text">全体最適の視点で、部門間の利害調整や優先順位付けができる</div>
        <div class="options">
          <label class="option-label">
            <input type="radio" name="Q17" value="1" onchange="updateProgress()">
            <div class="option-btn">1<br>全くそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q17" value="2" onchange="updateProgress()">
            <div class="option-btn">2<br>あまりそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q17" value="3" onchange="updateProgress()">
            <div class="option-btn">3<br>どちらでも<br>ない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q17" value="4" onchange="updateProgress()">
            <div class="option-btn">4<br>やや<br>そう思う</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q17" value="5" onchange="updateProgress()">
            <div class="option-btn">5<br>非常に<br>そう思う</div>
          </label>
        </div>
      </div>

      <div class="question-block" id="qblock18">
        <div class="question-number">Q18</div>
        <div class="question-text">周囲からの評価やフィードバックを積極的に求め、自己改善に活かす</div>
        <div class="options">
          <label class="option-label">
            <input type="radio" name="Q18" value="1" onchange="updateProgress()">
            <div class="option-btn">1<br>全くそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q18" value="2" onchange="updateProgress()">
            <div class="option-btn">2<br>あまりそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q18" value="3" onchange="updateProgress()">
            <div class="option-btn">3<br>どちらでも<br>ない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q18" value="4" onchange="updateProgress()">
            <div class="option-btn">4<br>やや<br>そう思う</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q18" value="5" onchange="updateProgress()">
            <div class="option-btn">5<br>非常に<br>そう思う</div>
          </label>
        </div>
      </div>

      <div class="question-block" id="qblock19">
        <div class="question-number">Q19</div>
        <div class="question-text">「なぜこのプロセスが必要か」を常に問い直し、PDCAを回し続けている</div>
        <div class="options">
          <label class="option-label">
            <input type="radio" name="Q19" value="1" onchange="updateProgress()">
            <div class="option-btn">1<br>全くそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q19" value="2" onchange="updateProgress()">
            <div class="option-btn">2<br>あまりそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q19" value="3" onchange="updateProgress()">
            <div class="option-btn">3<br>どちらでも<br>ない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q19" value="4" onchange="updateProgress()">
            <div class="option-btn">4<br>やや<br>そう思う</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q19" value="5" onchange="updateProgress()">
            <div class="option-btn">5<br>非常に<br>そう思う</div>
          </label>
        </div>
      </div>

      <div class="question-block" id="qblock20">
        <div class="question-number">Q20</div>
        <div class="question-text">想定外の事態が起きても、冷静に対処できる方だ</div>
        <div class="options">
          <label class="option-label">
            <input type="radio" name="Q20" value="1" onchange="updateProgress()">
            <div class="option-btn">1<br>全くそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q20" value="2" onchange="updateProgress()">
            <div class="option-btn">2<br>あまりそう<br>思わない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q20" value="3" onchange="updateProgress()">
            <div class="option-btn">3<br>どちらでも<br>ない</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q20" value="4" onchange="updateProgress()">
            <div class="option-btn">4<br>やや<br>そう思う</div>
          </label>
          <label class="option-label">
            <input type="radio" name="Q20" value="5" onchange="updateProgress()">
            <div class="option-btn">5<br>非常に<br>そう思う</div>
          </label>
        </div>
      </div>

      <button type="button" class="submit-btn" onclick="submitDiag()">診断結果を見る →</button>
      <p class="error-msg" id="errorMsg">⚠️ すべての質問にお答えください</p>
    </form>
  </div>

  <!-- RESULT SECTION -->
  <div id="resultSection">
    <div class="result-header">
      <h2>あなたのタイプは...</h2>
      <div class="char-img-wrap" id="charImgWrap">
        <span class="char-emoji" id="charEmoji"></span>
      </div>
      <div class="result-type" id="resultType"></div>
      <div class="result-tagline" id="resultTagline"></div>
    </div>

    <div class="score-section">
      <h3>📊 タイプ別スコア</h3>
      <div id="scoreRows"></div>
    </div>

    <div class="result-detail" id="resultDetail">
      <h3>🔍 あなたの特徴</h3>
      <p id="resultDescription"></p>
      <h3>💼 適性のある業務・役割</h3>
      <div class="jobs-list" id="resultJobs"></div>
      <h3 style="margin-top:15px;">✨ 強みの活かし方</h3>
      <p id="resultStrength"></p>
      <div class="career-box" id="resultCareer"></div>
    </div>

    <div class="web-link-box">
      <h3>🌐 より詳しい診断はWebで！</h3>
      <p>本診断の詳細版をWebサイトでもお試しいただけます。<br>スマートフォンやPCからアクセスしてください。</p>
      <a href="https://keiri-shindan.vercel.app/" target="_blank" class="web-link-btn">▶ Web版で診断する</a>
      <div class="web-url-text">https://keiri-shindan.vercel.app/</div>
    </div>

    <div class="disclaimer">
      <strong>免責事項：</strong>本診断は統計データに基づかない簡易版であり，性格特性を測定したり，個人の特性を断定したりするものではありません。あくまでも，自己理解のきっかけとしてご活用ください。
    </div>

    <button type="button" class="retry-btn" onclick="retryDiag()">🔄 もう一度診断する</button>
  </div>
</div>

<script>
const typeData = {
  A: {
    name: "正確性の番人型",
    tagline: "細部まで正確に、信頼の礎を築く",
    emoji: "🔍",
    imgUrl: "https://www.genspark.ai/api/files/s/jcOchcN1?cache_control=3600",
    color: "#1a237e",
    description: "あなたは正確さと信頼性を最も大切にするタイプです。ルーティン業務を高い水準で維持しながら、ミスゼロに向けた徹底した確認習慣を持っています。細部への注意力と規律ある作業スタイルが、組織の財務情報の信頼性を支えています。プレッシャーの高い決算期や監査対応においても、落ち着いて正確な作業をこなせる強みがあります。",
    jobs: ["月次・年次決算業務", "税務申告・税務対応", "監査対応・内部統制", "証憑管理・記帳業務", "財務諸表作成"],
    strength: "あなたの強みは「揺るぎない正確さ」です。チームにとってあなたは、数字の最終確認者として欠かせない存在。その丁寧さと責任感は、組織の財務情報の品質を守る重要な柱となっています。",
    career: "🚀 キャリアの可能性: 経理スペシャリスト → 主任・課長補佐 → 経理マネージャー。税理士・公認会計士資格取得によりさらなるステップアップも可能。"
  },
  B: {
    name: "戦略提案型",
    tagline: "数字から戦略を描く、経営のパートナー",
    emoji: "📈",
    imgUrl: "https://www.genspark.ai/api/files/s/B8o6lX13?cache_control=3600",
    color: "#0d47a1",
    description: "あなたは数字の背景にある事業の実態を深く洞察し、経営判断に貢献することに強みを持つタイプです。単なる数値の集計にとどまらず、データを分析して経営陣への提言を行うことに積極的です。マクロとミクロの両視点を持ち、全体最適を意識した意思決定をサポートします。知識習得への意欲も高く、最新の財務トレンドや会計基準への対応力も備えています。",
    jobs: ["財務分析・経営分析", "予算策定・管理会計", "経営企画・中期計画", "IR（投資家向け広報）", "M&A・事業投資評価"],
    strength: "あなたの強みは「数字から価値を生み出す洞察力」です。経営陣と現場をつなぐ「数字で語れる参謀」として、組織の意思決定に大きく貢献できます。",
    career: "🚀 キャリアの可能性: 財務アナリスト → 経営企画マネージャー → CFO・財務部長。MBA取得やCFO資格によりさらなる飛躍も。"
  },
  C: {
    name: "チームリーダー型",
    tagline: "人と組織をつなぎ、成長を促す",
    emoji: "🤝",
    imgUrl: "https://www.genspark.ai/api/files/s/cKLFMmrQ?cache_control=3600",
    color: "#1b5e20",
    description: "あなたは人との関係構築と組織の成長に強みを持つタイプです。他部署との調整や折衝を積極的に行い、チームの総合力を引き出すことが得意です。後輩や部下の育成を惜しまず、周囲からのフィードバックを取り入れて自己成長にも熱心です。評価や人間関係への感受性が高く、組織の心理的安全性を高める行動を自然に取ることができます。",
    jobs: ["経理・財務マネジメント", "部門間プロジェクトリーダー", "人材育成・研修担当", "社内調整・コーディネーター", "業務標準化・マニュアル整備"],
    strength: "あなたの強みは「人を動かし、組織をまとめる力」です。技術的なスキルだけでなく、チームの雰囲気を良くし、全員の力を引き出すリーダーシップが最大の武器です。",
    career: "🚀 キャリアの可能性: チームリーダー → 経理課長・財務部長 → 経営管理本部長。管理職・役員としてのキャリア形成に最も適したタイプ。"
  },
  D: {
    name: "改革イノベーター型",
    tagline: "変化を恐れず、未来を創る",
    emoji: "🚀",
    imgUrl: "https://www.genspark.ai/api/files/s/uq4K4SkF?cache_control=3600",
    color: "#b71c1c",
    description: "あなたは現状に満足せず、常により良い方法を探し続けるタイプです。業務フローの非効率に気づき、RPA・AIなどの最新技術も積極的に取り入れながら改善を推進します。新しい会計基準や制度改正にも素早く対応し、PDCAを継続的に回す姿勢が際立っています。変化の激しいビジネス環境において、経理部門の進化をリードする存在です。",
    jobs: ["業務改善・プロセス改革", "DX推進・RPA導入", "システム刷新・ERP実装", "業務フロー設計・最適化", "新制度・会計基準対応"],
    strength: "あなたの強みは「変化を価値に変える推進力」です。現状の問題点を鋭く察知し、テクノロジーと知識を駆使して組織を進化させる「経理部門のDXリーダー」として活躍できます。",
    career: "🚀 キャリアの可能性: 業務改善担当 → DX推進マネージャー → CDO（最高デジタル責任者）・経理部長。デジタルとファイナンスを融合した次世代型リーダーへ。"
  },
  E: {
    name: "バランス調整型",
    tagline: "臨機応変に、組織の要として活躍",
    emoji: "⚖️",
    imgUrl: "https://www.genspark.ai/api/files/s/Z67MZHmv?cache_control=3600",
    color: "#e65100",
    description: "あなたはルーティン業務も変化への対応も同じ水準でこなせる、バランスに優れたタイプです。単独作業もチーム作業も得意で、複数のプロジェクトを同時に管理する能力に長けています。想定外の事態が起きても冷静に対処でき、状況に応じて柔軟に自分のスタイルを変えることができます。組織の中心で多様な役割を担い、縦横無尽に活躍できる万能型のプロフェッショナルです。",
    jobs: ["複数プロジェクト統括管理", "新規事業・組織立ち上げ", "危機対応・緊急業務", "部長・マネージャー職", "社内横断チームのリーダー"],
    strength: "あなたの強みは「どんな状況でも力を発揮できる適応力と総合力」です。特定の専門に縛られず、組織が必要とする場所でその力を発揮できる「オールラウンダー」は、変化の時代の経理財務部門に最も求められる人材です。",
    career: "🚀 キャリアの可能性: 複数領域を横断するゼネラリスト → 経理財務部長 → CFO・経営幹部。多様な経験を積むことで、より大きなステージへのキャリアが開けます。"
  }
};

const typeNames = {
  A: "正確性の番人型",
  B: "戦略提案型",
  C: "チームリーダー型",
  D: "改革イノベーター型",
  E: "バランス調整型"
};

function updateProgress() {
  const total = 20;
  const answered = document.querySelectorAll('input[type="radio"]:checked').length;
  const pct = Math.round((answered / total) * 100);
  document.getElementById('progressBar').style.width = pct + '%';
  document.getElementById('progressText').textContent = answered + ' / ' + total + ' 問回答済み';
}

function submitDiag() {
  const qTypes = ['A','B','C','D','E','A','B','C','D','E','A','B','C','D','E','A','B','C','D','E'];
  const qNums = ['Q1','Q2','Q3','Q4','Q5','Q6','Q7','Q8','Q9','Q10','Q11','Q12','Q13','Q14','Q15','Q16','Q17','Q18','Q19','Q20'];
  
  let scores = {A:0, B:0, C:0, D:0, E:0};
  let allAnswered = true;
  
  for (let i = 0; i < 20; i++) {
    const radios = document.getElementsByName(qNums[i]);
    let answered = false;
    for (let r of radios) {
      if (r.checked) {
        scores[qTypes[i]] += parseInt(r.value);
        answered = true;
        break;
      }
    }
    if (!answered) {
      allAnswered = false;
      document.getElementById('qblock' + (i+1)).style.border = '2px solid #e53935';
    } else {
      document.getElementById('qblock' + (i+1)).style.border = '1px solid #e0e0e0';
    }
  }
  
  if (!allAnswered) {
    document.getElementById('errorMsg').style.display = 'block';
    const firstUnanswered = document.querySelector('.question-block[style*="e53935"]');
    if (firstUnanswered) firstUnanswered.scrollIntoView({behavior:'smooth', block:'center'});
    return;
  }
  
  document.getElementById('errorMsg').style.display = 'none';
  showResult(scores);
}

function showResult(scores) {
  let maxType = 'A';
  let maxScore = 0;
  for (let t of ['A','B','C','D','E']) {
    if (scores[t] > maxScore) { maxScore = scores[t]; maxType = t; }
  }
  
  const data = typeData[maxType];
  
  // Character image
  const wrap = document.getElementById('charImgWrap');
  wrap.innerHTML = '';
  const img = document.createElement('img');
  img.src = data.imgUrl;
  img.alt = data.name;
  img.onerror = function() {
    wrap.innerHTML = '<span class="char-emoji">' + data.emoji + '</span>';
  };
  wrap.appendChild(img);
  
  document.getElementById('resultType').textContent = data.name;
  document.getElementById('resultTagline').textContent = data.tagline;
  document.getElementById('resultDescription').textContent = data.description;
  document.getElementById('resultStrength').textContent = data.strength;
  document.getElementById('resultCareer').textContent = data.career;
  
  const jobsDiv = document.getElementById('resultJobs');
  jobsDiv.innerHTML = '';
  for (let j of data.jobs) {
    const tag = document.createElement('span');
    tag.className = 'job-tag';
    tag.textContent = j;
    jobsDiv.appendChild(tag);
  }
  
  // Score bars
  const maxPossible = 20;
  const scoreRows = document.getElementById('scoreRows');
  scoreRows.innerHTML = '';
  for (let t of ['A','B','C','D','E']) {
    const pct = Math.round((scores[t] / maxPossible) * 100);
    const isTop = t === maxType;
    scoreRows.innerHTML += `
      <div class="score-row">
        <div class="score-label" style="${isTop ? 'font-weight:bold;color:#4a2c8a;' : ''}">${typeNames[t]}</div>
        <div class="score-bar-wrap"><div class="score-bar" style="width:${pct}%;${isTop ? '' : 'background:linear-gradient(90deg,#b39ddb,#9c8ac0);'}"></div></div>
        <div class="score-num">${scores[t]}点</div>
      </div>`;
  }
  
  document.getElementById('quizSection').style.display = 'none';
  document.getElementById('resultSection').style.display = 'block';
  window.scrollTo({top: 0, behavior: 'smooth'});
}

function retryDiag() {
  document.getElementById('diagForm').reset();
  document.getElementById('quizSection').style.display = 'block';
  document.getElementById('resultSection').style.display = 'none';
  document.getElementById('progressBar').style.width = '0%';
  document.getElementById('progressText').textContent = '0 / 20 問回答済み';
  const blocks = document.querySelectorAll('.question-block');
  blocks.forEach(b => b.style.border = '1px solid #e0e0e0');
  window.scrollTo({top: 0, behavior: 'smooth'});
}
</script>
</body>
</html>